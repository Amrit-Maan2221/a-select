!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery"),require("@popperjs/core"),require("bootstrap")):"function"==typeof define&&define.amd?define(["jquery","@popperjs/core","bootstrap"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).ASelect=e(t.$,t.Popper)}(this,function(t,e){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=s(t),i=s(e);const l=a.default.fn.val;function o(t="a-select-"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return t+Array.from({length:8},()=>e.charAt(Math.floor(52*Math.random()))).join("")}function n(t,e,s=!0){if(!t.length)return;const a=t.position().top,i=3*t.outerHeight(),l=e.height(),o=e.scrollTop();let n=null;a+i>l+o?n=a+i-l:o>0&&a-i<o&&(n=Math.max(a-i,0)),null!==n&&(s?e.stop().animate({scrollTop:n},100):e.scrollTop(n))}function r(t){if(!t)return"";return t.replace(/^[a-z]+/,"").replace(/([A-Z])/g," $1").trim()}function d(t,e){t&&t.length?(h(t),t.attr("data-bs-toggle","tooltip").attr("title",e).tooltip("dispose").tooltip({placement:"bottom",trigger:"hover"})):console.warn("Element does not exist in DOM",t)}function h(t){t&&t.length?(t.tooltip("dispose"),t.removeAttr("data-bs-toggle").removeAttr("title")):console.warn("Element does not exist in DOM",t)}a.default.fn.val=function(t){return void 0===t?l.call(this):this.each(function(){const e=a.default(this).data("aselect");e?e.selectRow(t,!1):l.call(a.default(this),t)})};const c="aselect",p="data-quicklink",u="data-show-clear-button",f="data-headers",b="data-url",$="data-unique-by",w="data-creatable",g="data-depends-on",v="data-hide-excluded",y="multiple";a.default.fn.aSelect=function(t){if("string"==typeof t){const e=t;return this.each(function(){const t=a.default(this).data(c);t&&"function"==typeof t[e]&&t[e]()})}const e=a.default.fn.aSelect.defaults||{},s=a.default.extend({onOpen:null,uniqueBy:[],onClose:null,onChange:null,showClearButton:!1,quickLinks:"",dependsOn:[],ajaxUrl:null,headers:[],creatable:!1,hideExcluded:!0,placeHolder:"-- Select --",getAjaxDefaultPayload:()=>({}),id:o()},e,t);return this.each(function(){const t=a.default(this);if(!t.data(c)){t.attr(p)&&(s.quickLinks=a.default(t.attr(p)).prop("outerHTML")),t.attr(u)&&(s.showClearButton="true"==t.attr(u)),t.attr(f)&&(s.headers=t.attr(f).split(",").map(t=>t.trim())),t.attr(b)&&(s.ajaxUrl=t.attr(b)),t.attr($)&&(s.uniqueBy=t.attr($).split(",").map(t=>t.trim())),t.attr(w)&&(s.creatable="true"==t.attr(w)),t.attr(v)&&(s.hideExcluded="true"==t.attr(v)),t.attr(y)&&(s.multiple=t.prop(y));let e=t.attr(g);e&&(s.dependsOn=JSON.parse(e));const i=t.find(`option[value="${t.val()}"]`);i.length&&(s.placeHolder=i.text()||s.placeHolder),t.data(c,new m(t,s))}})};class m{constructor(t,e){this.$select=t,this.options=e,this.isServerSide=!!e.ajaxUrl,this.pageSize=20,this.currentPage=0,this.hasMorePages=!0,this.isLoading=!1,this.initComplete=!1,this.uniqueSelectors=e.uniqueBy||[],this.isMultiple=e.multiple,this.init()}init(){this.buildBaseStructure(),this.initializePopper(),(this.$select.is(":disabled")||this.$select.is("[readonly]"))&&this.disableSelect(),this.setupMutationObservers(),this.isServerSide?this.initializeServerSide():this.initializeClientSide()}buildBaseStructure(){this.$wrapper=a.default(`<div class="a-select-wrapper" data-aselect-id="${this.options.id}""></div>`),this.$wrapper.data("select",this.$select),this.$display=a.default('<div class="a-select-display" tabindex="0"></div>').text(this.options.placeHolder),this.isMultiple||this.$display.css("min-height",`${this.$select.outerHeight()}px`),this.$display.addClass(this.$select.attr("class")||""),this.updateDisplayContent(),this.isServerSide&&d(this.$display,"Loading..."),this.$dropdown=a.default(`<div class="a-select-dropdown card shadow-lg" data-aselect-id="${this.options.id}" style="display: none; z-index: 9999;"></div>`),this.$filterConatiner=a.default('<div class="a-select-filter-container px-1 p-2"></div>'),this.$search=a.default('<input type="text" class="form-control form-control-sm" placeholder="Search..."/>'),this.$tableContainer=a.default('<div class="a-select-table-container overflow-y-auto" style="max-height: 400px;"></div>'),this.$table=a.default('<table class="table table-sm a-select-table mb-0" style="margin-bottom: 0;"></table>'),this.$tableHead=a.default('<thead class="bg-light position-sticky" style="z-index: 1;top:-1px"></thead>'),this.$tableHeadRow=a.default("<tr></tr>"),this.$tableBody=a.default("<tbody></tbody>"),this.$filterConatiner.append(this.$search).append(this.options.quickLinks),this.$tableHead.append(this.$tableHeadRow),this.$table.append(this.$tableHead).append(this.$tableBody),this.$tableContainer.append(this.$table),this.$dropdown.append(this.$filterConatiner).append(this.$tableContainer),this.$wrapper.append(this.$display).append(this.$dropdown),this.options.showClearButton&&(this.$clearButton=a.default('<button type="button" class="a-select-clear-button btn btn-sm position-absolute" tabindex="-1" aria-label="Clear selection"><i class="bi bi-x"></i></button>'),this.$wrapper.append(this.$clearButton)),this.$select.addClass("a-select-hidden").attr("data-aselect-id",this.options.id),this.$select.after(this.$wrapper)}initializeClientSide(){let t=!1;if(this.options.headers.length){for(const t of this.options.headers){const e=r(t);this.$tableHeadRow.append(`<th>${e}</th>`)}t=!0}const e=this;this.$select.find("option").each(function(){const s=a.default(this);if(!s.val())return;const i=a.default('<tr role="option"></tr>').attr("data-select-id",s.val());t?e.options.headers.forEach(t=>{const e=s.data(`${t.toLowerCase()}`)||"";i.append(`<td>${e}</td>`)}):i.append(`<td>${s.text()}</td>`),e.$tableBody.append(i)}),this.finalizeInitialization()}initializeServerSide(){this.appendPlaceholderOption(),this.checkDependentFields(),this.bindDependentFields(),this.buildTableSchema().then(()=>{this.finalizeInitialization()})}bindDependentFields(){const t=this;this.options.dependsOn.forEach(e=>{const s=a.default(e.selector);s.length&&s.on("change.aSelect",function(){console.log("Dependent val changed:",s.val()),t.reload=!0,t.selectRow(""),t.checkDependentFields()})})}appendPlaceholderOption(){const t=a.default("<option>").val("").text(this.options.placeHolder).attr("data-a","1");this.$select.append(t)}finalizeInitialization(){const t=this.$select.val();t&&this.selectRow(t,!1),this.isServerSide&&h(this.$display),this.bindEvents(),this.updateClearButtonVisibility(),this.initComplete=!0}waitForInit(t){const e=setInterval(()=>{this.initComplete&&(clearInterval(e),t())},50)}bindEvents(){this.updateEventsOnDisplay(),this.setupSearchEvent(),this.setupTableRowClickEvent(),this.setupMouseEvents(),this.setupDropdownKeyboardNavigation(),this.options.showClearButton&&this.$clearButton.on("click.aSelect",t=>{t.stopPropagation(),this.selectRow(""),this.isMultiple||this.closeDropdown()})}setupDropdownKeyboardNavigation(){let t=this;this.$dropdown.on("keydown.aSelect",function(e){const s=t.$tableBody.find("tr:visible").not(".aselect-ignore, .a-select-row-exclude");if(t.options.creatable&&"Enter"===e.key&&1==s.length&&s.first().hasClass("a-select-creatable-row")){e.preventDefault();const s=t.$search.val().trim();return void(s&&t.handleCreatableEntry(s))}let a=s.filter(".table-warning");if(a.length||(a=s.filter(".table-primary").first()),"ArrowDown"===e.key){e.preventDefault();let i=s.first();a.length&&(i=a.nextAll(":visible").not(".aselect-ignore, .a-select-row-exclude").first()),i.length&&(a.removeClass("table-warning"),i.addClass("table-warning"),n(i,t.$tableContainer))}else if("ArrowUp"===e.key){e.preventDefault();let i=s.first();a.length&&(i=a.prevAll(":visible").not(".aselect-ignore, .a-select-row-exclude").first()),i.length&&(a.removeClass("table-warning"),i.addClass("table-warning"),n(i,t.$tableContainer))}else if("Enter"===e.key||"Tab"===e.key){e.preventDefault();const s=a.attr("data-select-id");s&&(t.selectRow(s),t.closeDropdown())}else"Escape"===e.key&&(e.preventDefault(),t.closeDropdown())})}setupMouseEvents(){let t=this;this.$tableBody.on("mouseenter.aSelect","tr:not(.aselect-ignore)",function(){t.$tableBody.find("tr").removeClass("table-warning"),a.default(this).addClass("table-warning")}),this.$tableBody.on("mouseleave.aSelect","tr:not(.aselect-ignore)",function(){a.default(this).removeClass("table-warning")})}setupTableRowClickEvent(){let t=this;this.$tableBody.on("click.aSelect","tr:not(.aselect-ignore)",function(){const e=a.default(this);if(e.hasClass("a-select-row-exclude"))return;if(t.options.creatable&&e.hasClass("a-select-creatable-row")){const e=t.$search.val().trim();return void(e&&t.handleCreatableEntry(e))}const s=e.attr("data-select-id");if(t.isMultiple){(t.$select.val()||[]).includes(s)?t.deselectValue(s):t.selectRow(s)}else t.selectRow(s),t.closeDropdown()})}setupSearchEvent(){let t,e=this;this.$search.on("input.aSelect",function(){const s=a.default(this).val().trim(),i=s.toLowerCase();e.isServerSide&&e.bitImplementPagination?(clearTimeout(t),t=setTimeout(()=>{e.loadedValSearchResult!=i&&(e.loadedValSearchResult=i,e.loadServerData(!0).then(()=>{e.updateSelectedValueIfNeedOnSearch(e),e.handleCreatableOption(s),e.excludeRows()}))},300)):(e.$tableBody.find("tr").each(function(){const t=a.default(this),e=t.text().toLowerCase();t.toggle(e.includes(i))}),e.updateSelectedValueIfNeedOnSearch(e),e.handleCreatableOption(s))})}handleCreatableOption(t){if(this.options.creatable&&t.length>0){0===this.$tableBody.find("tr:visible").not(".a-select-creatable-row, .aselect-ignore").length?this.showCreatableOption(t):this.hideCreatableOption()}else this.hideCreatableOption()}showCreatableOption(t){this.hideCreatableOption();const e=a.default(`\n                    <tr class="a-select-creatable-row table-success" data-creatable-row="true">\n                        <td colspan="${this.$tableHeadRow.find("th").length}">\n                            <i class="bi bi-plus me-1"></i>Create new: "${t}"\n                        </td>\n                    </tr>\n                `);this.$tableBody.prepend(e)}hideCreatableOption(){this.$tableBody.find(".a-select-creatable-row").remove()}handleCreatableEntry(t){const e="new:"+t,s=a.default("<option>").val(e).text(t).attr("data-new","true");this.$select.append(s),this.selectRow(e),this.closeDropdown(),this.$search.val(""),this.hideCreatableOption(),this.$select.trigger("newentry",[e,t])}initializePopper(){this.popperInstance=i.default.createPopper(this.$display[0],this.$dropdown[0],{placement:"bottom-start",modifiers:[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"preventScroll",enabled:!0}]})}disableSelect(){this.$wrapper.addClass("a-select-disabled"),this.updateEventsOnDisplay()}enableSelect(){this.$wrapper.removeClass("a-select-disabled"),this.updateEventsOnDisplay()}updateEventsOnDisplay(){if(this.$wrapper.hasClass("a-select-disabled"))this.$display.off("click.aSelect keydown.aSelect"),this.$display.attr("tabindex","-1"),this.$display.attr("aria-disabled","true");else{const t=this;this.$display.off("click.aSelect").on("click.aSelect",function(e){e.stopPropagation(),t.$dropdown.is(":visible")?t.closeDropdown():t.openDropdown()}),this.$display.off("keydown.aSelect").on("keydown.aSelect",function(e){if("Enter"===e.key||" "===e.key)e.preventDefault(),t.openDropdown();else if("ArrowDown"===e.key&&!$dropdown.is(":visible")){e.preventDefault(),t.openDropdown();const s=t.$tableBody.find("tr:visible").first();s.length&&s.addClass("table-warning")}}),this.$display.attr("tabindex","0"),this.$display.attr("aria-disabled","false")}}closeDropdown(){this.$dropdown.hide(),this.$tableBody.find("tr.table-warning").removeClass("table-warning"),this.$wrapper.removeClass("a-select-open"),this.$dropdown.parent().is(this.$wrapper)||this.$dropdown.detach().appendTo(this.$wrapper),this.$scrollableParents&&this.$scrollableParents.each(function(){a.default(this).off("scroll.aSelect")}),a.default(document).off("mousedown.aSelect focusin.aSelect"),this.$display.trigger("focus")}afterDropdownOpenDataLoad(){this.excludeRows(),this.setUpStylesOnDropdownOpen()}setUpStylesOnDropdownOpen(){this.$dropdown.css({minWidth:this.$wrapper.outerWidth(),maxWidth:"80vw",width:"max-content"})}adjustDropdownPosition(){let t=this.$dropdown.parent();for(;t.length&&!t.is("body");){const e=t.css("overflowY");if("auto"===e||"scroll"===e)break;t=t.parent()}const e=this.$wrapper.offset(),s=t.offset(),a=e.top-s.top+this.$wrapper.outerHeight(),i=e.top-s.top,l=t.innerHeight()-a;let o=Math.min(416,l);o<200&&i>200?(this.popperInstance.setOptions({placement:"top-start"}),o=200):this.popperInstance.setOptions({placement:"bottom-start"}),this.$tableContainer.css("max-height",o-63+"px"),this.popperInstance.update()}scrollIntoSelectedRow(){const t=this.$select.val(),e=this.$tableBody.find(`tr[data-select-id="${t}"]:visible`);e.length&&n(e,this.$tableContainer,!1)}openDropdown(){this.$dropdown.parent().is("body")||this.$dropdown.detach().appendTo("body"),this.$dropdown.show(),this.options.ajaxUrl?this.reload||!this.initialDataLoaded||this.loadedValSearchResult!=this.$search.val()&&this.bitImplementPagination?(this.loadedValSearchResult=this.$search.val(),this.reload=!1,this.initialDataLoaded=!0,this.loadServerData(!0).then(()=>{this.afterDropdownOpenDataLoad()})):this.excludeRows():this.afterDropdownOpenDataLoad(),this.$wrapper.addClass("a-select-open"),this.popperInstance.update(),this.$search[0].focus({preventScroll:!0}),setTimeout(()=>{this.adjustDropdownPosition()},0),this.$scrollableParents=this.$select.parents().filter(function(){return"auto"===a.default(this).css("overflow")||"scroll"===a.default(this).css("overflow-y")||"scroll"===a.default(this).css("overflow-x")}),this.$scrollableParents&&this.$scrollableParents.each(function(){a.default(this).on("scroll.aSelect",this.closeDropdown)}),this.scrollIntoSelectedRow();const t=this;a.default(document).on("mousedown.aSelect focusin.aSelect",function(e){a.default(e.target).closest(`.a-select-wrapper[data-aselect-id="${t.options.id}"]`).length||a.default(e.target).closest(`.a-select-dropdown[data-aselect-id="${t.options.id}"]`).length||t.closeDropdown()})}loadServerData(t=!1){return new Promise((e,s)=>{let i=this.$table.find("thead tr td, thead tr th").length;t&&(this.currentPage=0,this.hasMorePages=!0,this.$tableBody.empty()),!this.isLoading&&this.hasMorePages?(this.isLoading=!0,a.default.ajax({url:this.options.ajaxUrl,method:"POST",data:{...this.options.getAjaxDefaultPayload(),start:this.currentPage*this.pageSize,length:this.$filterConatinerpageSize,search:this.bitImplementPagination?this.$search.val():"",valColumn:this.valColumn,selectedValue:this.$select.val(),onlyFetchSelectedRow:!1,initialLoad:!1,headers:this.options.headers,dependsOn:{...this.getDependentFields()}},success:t=>{this.isLoading=!1;const s=t.data||[];if(!s.length)return 0==this.$tableBody.find("tr").length&&this.$tableBody.append(`<tr class="table-danger aselect-ignore"><td colspan="${i||1}" class="text-center">No data</td></tr>`),this.hasMorePages=!1,void e([]);s.forEach(t=>{this.upsertSelectOption(t),this.appendRowIfDoesNotExist(t)}),s.length<this.pageSize?this.hasMorePages=!1:this.currentPage++,e(s)},error:(t,s,a)=>{this.isLoading=!1,this.$tableBody.append('<tr class="table-danger aselect-ignore"><td colspan="'+(i||1)+'">Error loading data</td></tr>'),e()}})):e()})}upsertSelectOption(t){const e=t[this.valColumn],s=t[this.textColumn];let i=this.$select.find(`option[value="${e}"]`);if(0===i.length){i=a.default("<option>").val(e).text(s).attr("data-a","1");for(const e in t)i.attr(`data-${e.toLowerCase()}`,t[e]);this.$select.append(i)}else{i.text(s);for(const e in t)i.attr(`data-${e.toLowerCase()}`,t[e])}}appendRowIfDoesNotExist(t,e=!1){let s=this.$select.val();const i=t[this.valColumn];if(0==this.$tableBody.find(`[data-select-id="${i}"]`).length){const l=a.default("<tr>").attr("data-select-id",i);for(const e in t)this.skippedColumn.includes(e)||l.append(`<td>${t[e]}</td>`);s==i&&l.addClass("table-primary"),e?this.$tableBody.prepend(l):this.$tableBody.append(l)}}getDependentFields(){const t={};return this.options.dependsOn.forEach(e=>{const s=a.default(e.selector);s.length&&(t[e.param]=s.val())}),t}setupMutationObservers(){this.observers=[];const t=new MutationObserver(t=>{t.forEach(t=>{if("attributes"===t.type&&"value"===t.attributeName){const t=this.$select.attr("value");t!==this.$select.data("last-val")&&(this.$select.data("last-val",t),this.initComplete?this.selectRow(t):this.waitForInit(()=>{this.selectRow(t)}))}else"attributes"!==t.type||"disabled"!==t.attributeName&&"readonly"!=t.attributeName||(this.$select.is(":disabled")||this.$select.is("[readonly]")?this.disableSelect():this.enableSelect())})});if(t.observe(this.$select[0],{attributes:!0,attributeFilter:["value","disabled","readonly"]}),this.observers.push(t),!this.isServerSide){const t=new MutationObserver(t=>{let e=!1;t.forEach(t=>{"childList"===t.type&&t.addedNodes.length>0&&(e=!0)}),e&&this.refresh()});t.observe(this.$select[0],{childList:!0,subtree:!1}),this.observers.push(t)}}highlightRow(t,e=!0){this.$table.find("tbody tr").removeClass("table-primary");const s=this.$table.find(`[data-select-id="${t}"]`);s.length&&(s.addClass("table-primary"),this.$wrapper.hasClass("a-select-open")&&e&&n(s,this.$tableContainer)),this.$tableBody.find("tbody tr").removeClass("table-warning")}showSelectedValue(t,e){if(this.isMultiple){var s=this.$select.val();s.includes(t)||(s.push(t),l.call(this.$select,s))}else l.call(this.$select,t);e&&this.$select.trigger("change"),this.updateDisplayContent(),this.highlightSelectedRows(t)}highlightSelectedRows(t=!0){if(this.$table.find("tbody tr").removeClass("table-primary"),this.isMultiple){(this.$select.val()||[]).forEach(t=>{const e=this.$table.find(`[data-select-id="${t}"]`);e.length&&e.addClass("table-primary")})}else{const e=this.$table.find(`[data-select-id="${this.$select.val()}"]`);e.length&&(e.addClass("table-primary"),this.$wrapper.hasClass("a-select-open")&&t&&n(e,this.$tableContainer))}this.$tableBody.find("tbody tr").removeClass("table-warning")}selectRow(t,e=!0){const s=this.$select.find(`option[value="${t}"]`);if(!s.length||this.options.ajaxUrl&&!s.attr("data-new")){if(this.options.ajaxUrl){if(!t)return this.showSelectedValue(t,e),void this.updateClearButtonVisibility();this.$tableBody.find(`[data-select-id="${t}"]`).length&&s.length?(this.showSelectedValue(t,e),this.updateClearButtonVisibility()):(s.length&&s.text()&&(this.$display.text(s.text()),this.updateClearButtonVisibility()),a.default.ajax({url:this.options.ajaxUrl,type:"POST",data:{start:-1,length:-1,search:"",selectedValue:t,valColumn:this.valColumn,onlyFetchSelectedRow:!0,initialLoad:!1,headers:this.options.headers,dependsOn:{...this.getDependentFields()},...this.options.getAjaxDefaultPayload()},success:s=>{const a=s.selectedRow;a&&(this.upsertSelectOption(a),this.appendRowIfDoesNotExist(a,!0),this.showSelectedValue(t,e),this.updateClearButtonVisibility())},error:(t,e,s)=>{this.$tableBody.append('<tr class="table-danger aselect-ignore"><td colspan="'+(headerLength||1)+'">Error loading data</td></tr>')}}))}}else this.showSelectedValue(t,e),this.updateClearButtonVisibility()}updateClearButtonVisibility(){if(this.options.showClearButton){const t=this.$select.val();if(this.isMultiple){(t||[]).length>0?this.$clearButton.show():this.$clearButton.hide()}else t?this.$clearButton.show():this.$clearButton.hide()}}buildTableSchema(){return new Promise((t,e)=>{let s={start:0,length:0,search:"",initialLoad:!0,onlyFetchSelectedRow:!1,dependsOn:{...this.getDependentFields()},...this.options.getAjaxDefaultPayload()};a.default.ajax({url:this.options.ajaxUrl,type:"POST",data:s,success:e=>{this.bitImplementPagination=e.bitImplementPagination,this.skippedColumn=(e.vcSkippedColumns||"").split(",").map(t=>t.trim()).filter(t=>t),this.textColumn=e.vcTextColumn,this.valColumn=e.vcValColumn;const s=e.data||[];this.options.headers=Object.keys(s[0]);const a=this.options.headers.filter(t=>!this.skippedColumn.includes(t));if(a.length>1)for(const t of a){const e=r(t);this.$tableHeadRow.append(`<th>${e}</th>`)}this.bitImplementPagination&&this.$tableContainer.on("scroll",()=>{if(!this.hasMorePages||this.isLoading)return;const t=this.$tableContainer.scrollTop(),e=this.$tableContainer[0].scrollHeight;t+this.$tableContainer.innerHeight()>=e-50&&this.loadServerData()}),t([])},error:()=>{this.$tableBody.html("<tr><td>Error loading data</td></tr>"),t([])}})})}checkDependentFields(){if(!this.options.dependsOn||0===this.options.dependsOn.length)return!0;let t=!0,e=[];return this.options.dependsOn.forEach(s=>{const i=a.default(s.selector);if(i.length&&(!i.val()||""===i.val())){t=!1;let s=i.data("label");e.push(s)}}),t?(this.$wrapper.hasClass("a-select-disabled")&&this.enableSelect(),h(this.$wrapper)):(this.$wrapper.hasClass("a-select-disabled")||this.disableSelect(),d(this.$wrapper,`Please select ${e.join(" and ")} first`)),t}updateSelectedValueIfNeedOnSearch(t){if(!t.isMultiple){const t=this.$select.val();if(!this.$tableBody.find(`tr[data-select-id="${t}"]:visible`).length){const t=this.$tableBody.find("tr:visible").not(".aselect-ignore").first();if(t.length){const e=t.attr("data-select-id");e&&this.selectRow(e)}}}}getUniqueValuesToExclude(){const t=[];return this.uniqueSelectors.forEach(e=>{a.default(e).not(this.$select).each(function(){const e=a.default(this).val();e&&t.push(e)})}),t}excludeRows(){if(this.uniqueSelectors.length>0){const t=this.getUniqueValuesToExclude();this.$tableBody.find("tr[data-select-id]").each((e,s)=>{const i=a.default(s),l=i.attr("data-select-id");t.includes(l)?(i.addClass("a-select-row-exclude"),this.options.hideExcluded&&i.addClass("d-none")):(i.removeClass("a-select-row-exclude"),this.options.hideExcluded&&i.removeClass("d-none"))})}}deselectValue(t){if(this.isMultiple){const e=(this.$select.val()||[]).filter(e=>e!=t);l.call(this.$select,e),this.$select.trigger("change"),this.updateDisplayContent(),this.highlightSelectedRows(),this.updateClearButtonVisibility()}}updateDisplayContent(){if(this.isMultiple){this.$select.val();const t=this.$select.find("option:selected");if(0===t.length)this.$display.text(this.options.placeHolder),this.$display.removeClass("a-select-multiple-display");else{this.$display.addClass("a-select-multiple-display");const e=t.map((t,e)=>{const s=a.default(e);return`\n                        <span class="a-select-chip">\n                            ${s.text()}\n                            <button type="button" class="a-select-chip-remove" data-value="${s.val()}">\n                                <i class="bi bi-x"></i>\n                            </button>\n                        </span>\n                    `}).get().join("");this.$display.html(e),this.$display.find(".a-select-chip-remove").on("click",t=>{t.stopPropagation();const e=a.default(t.currentTarget).data("value");this.deselectValue(e)})}}else{const t=this.$select.val(),e=this.$select.find(`option[value="${t}"]`),s=e.length?e.text():this.options.placeHolder;this.$display.text(s)}}cleanUp(){this.$wrapper.find("*").off(".aSelect"),a.default(document).off(".aSelect"),this.$wrapper.tooltip("dispose");for(const t of this.observers)t.disconnect();this.$select.find("option[data-a]").remove(),this.$select.removeClass("a-select-hidden").css("display","").removeData(c),this.$wrapper.remove()}destroy(){this.cleanUp()}refresh(){this.cleanUp(),this.$select.aSelect(this.options)}}return window.ASelect=m,m});
